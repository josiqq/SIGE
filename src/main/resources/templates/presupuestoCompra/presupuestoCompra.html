<!DOCTYPE html>
<html lang="es" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec=" http://www.thymeleaf.org/extras/spring-security5"
	layout:decorate="~{padron}"
	xmlns:data="http://www.thymeleaf.org/extras/data">
<head>
	<title>Presupuesto de Compras</title>
 	<link th:href="@{/css/easy-autocomplete.min.css}" rel="stylesheet">
 	<link th:href="@{/css/easy-autocomplete.themes.min.css}" rel="stylesheet">
</head>
<section layout:fragment="contenido">
	
	<div class="border-top border-bottom border-secondary border-1  p-4 m-4">
		<form th:method="POST" th:action="@{/presupuestoCompras}" th:object="${presupuestoCompra}">	
		<div class="row">
			<div class="alert alert-danger alert-dismissible fade show" role="alert" th:if="${#fields.hasAnyErrors()}">
				<div th:each="erro: ${#fields.detailedErrors()}">
					<i class="fa fa-exclamation-circle me-2"></i> 
					<span th:text="${erro.message}">Mensaje de error</span>
				</div>
				<button type="button" class="btn-close" data-bs-dismiss="alert"
						aria-label="Close"></button>
			</div>
			<div class="alert alert-primary alert-dismissible fade show" role="alert" th:if="${!#strings.isEmpty(mensaje)}">
				<i class="fa fa-exclamation-circle me-2"></i> 
				<span th:text="${mensaje}">Mensaje de exito</span>
				<button type="button" class="btn-close" data-bs-dismiss="alert"
						aria-label="Close"></button>
			</div>
			<div class=" row col-md-10 mb-2">
					<input type="hidden" id="uuid" th:field="*{uuid}">
					<input type="hidden" id="id" th:field="*{id}">
					<input type="hidden" id="registro" th:value="${registro}">
					<div class="row col-md-12 mb-2">
						<div class="col-md-4">
					        <h6>Presupuesto de compras</h6>
					    </div>
						<div class="col-md-6">
							<button class="btn btn-primary btn-sm btn-guardar" type="submit"
							sec:authorize="hasRole('ROLE_COMPRAS_PRESUPUESTO_COMPRAS_GUARDAR')">Guardar</button>
							<a th:href="@{/presupuestoCompras/buscar}">
								<button class="btn btn-success btn-sm" type="button">Buscar</button>	
							</a>
							
							<a th:href="@{/presupuestoCompras}">
								<button class="btn btn-secondary btn-sm" type="button">Nuevo</button>	
							</a>
							
						</div>
					</div>
					<div class=" mb-3 col-sm-12 col-xl-4 col-md-4">
                        <label for="proveedor" class="mediano control-label">Proveedor</label>
                        <input type="hidden" id="idProveedor" th:field="*{proveedor}">
                        <input type="text"  id="proveedor"  
                                	class="form-control mediano js-proveedor" 
                                	autocomplete="off" placeholder="Escribe el nombre o ruc"
                                	th:value=" ${presupuestoCompra.proveedor}?${presupuestoCompra.proveedor.nombre}:''">
                    </div>
					<div class="col-md-3  mb-3">
						<label class="control-label mediano">Fecha</label>
						<input type="text" class="form-control mediano date" autocomplete="off" id="fecha" th:field="*{fecha}">
					</div>
					<div class="col-md-3">
						<label class="control-label mediano">Dep贸sito</label>
						<select class="form-select form-select-sm mb-3" id="deposito" th:field="*{deposito}">
							<option value="">Seleccionar</option>
							<option th:each="deposito: ${depositos}" th:value="${deposito.id}" th:text="${deposito.nombre}">
							</option>
						</select>
					</div>
					<div class="col-md-3">
						<label class="control-label mediano">Moneda</label>
						<select class="form-select form-select-sm mb-3 " id="moneda" th:field="*{moneda}">
							<option value="">Seleccionar</option>
							<option th:each="moneda : ${monedas}" th:value="${moneda.id}" th:text="${moneda.nombre}"></option>
						</select>
					</div>
			</div>
			
			<div class="col-md-2 mb-2">
				<div class="col-sm-12 mb-2">
			        <div class="form-group">
			            <label for="usuario" class="mediano">Usuario</label>
						<input type="hidden" id="usuario" th:field="*{usuario}">
			            <input type="text" class="form-control mediano" id="usuario" 
							 th:value="${presupuestoCompra.usuario.nombre}" placeholder="usuario" readonly>
			        </div>
			    </div>
				<div class="col-sm-12 mb-2">
			        <div class="form-group">
			            <label for="total" class="mediano">Total</label>
			            <input type="text" class="form-control mediano" id="total" 
							th:field="*{total}" placeholder="0" readonly>
			        </div>
			    </div>
				
			</div>
		</div>
		</form>
		<div class="col-md-12 row border border-4">
			<div class=" row mb-3 col-sm-12 col-lg-5 col-md-5">
				<label for="producto" class="col-sm-12 col-form-label mediano">Producto</label>
				<input type="hidden" id="id-producto" >
				<div class="col-sm-10">
					<div class="meta-conten-group mediano">
						<input type="text" id="producto-nombre" class="form-control js-producto-nc mediano" autocomplete="off"
														placeholder="C贸digo o descripci贸n">
						<a href="#" class="mediano btn btn-primary" title="Presiona ALT+P para buscar producto" data-bs-toggle="modal"
									data-bs-target="#modal-buscar-producto" accesskey="p"> <i
									class="bi bi-search"></i>
						</a>
					</div>
					<div class="contenedor-lista-producto ">
						
						
					</div>
				</div>
			</div>
			<div class="col-md-3 mediano mb-3">
				<label class="col-form-label">Cantidad</label>
				<input type="text" class="form-control mediano formato-numero" 
					autocomplete="off" id="cantidad-det-nc">
			</div>
			<div class="col-md-3 mediano mb-3">
				<label class="col-form-label">Precio</label>
				<div class="col-sm-10">
					<div class="meta-conten-group mediano">
						<input type="text" id="precio-det-nc" class="form-control  mediano formato-numero" 
						       autocomplete="off" >
						<a href="#" class="mediano btn btn-primary btn-adiciona-item-nc" title="adicionar item"> 
							<i class="bi bi-plus-circle"></i>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="table-responsive p-3 m-2">
		<table class="table">
			<thead>
				<tr>
					<th>C贸digo</th>
					<th>Producto</th>
					<th>Cantidad</th>
					<th>Precio</th>
					<th>SubTotal</th>
					<th></th>
				</tr>
			</thead>
			<tbody class="item-presupuesto-compra">
				<th:block th:replace="presupuestoCompra/itemPresupuestoCompra"></th:block>
			</tbody>
		</table>
	</div>
	<th:block th:replace="producto/modal.buscar.producto"></th:block>
</section>
<th:block layout:fragment="javascript-extra">
	<script th:src="@{/js/meta/upload/handlebars.min.js?ver=0.2.2}"></script>
	<script th:src="@{/js/jquery.easy-autocomplete.min.js?ver=0.2.3}"></script>
	<script th:src="@{/js/meta/gasto/auto-complete-proveedor.js?ver=0.2.3}"></script>
	<script th:src="@{/js/meta/producto/modal.buscar.producto.js?ver=0.0.1}" type="module"></script>
	<script th:src="@{/js/meta/presupuestoCompra/presupuesto.compra.js?ver=0.0.1}" type="module"></script>
	<script th:src="@{/js/meta/presupuestoCompra/item.presupuesto.compra.js?ver=0.0.1}" type="module"></script>
</th:block>
</html>